let isAnimating=!1;function setAnimationState(e){isAnimating=e}function animateCardToSeries(t,n){if(!isAnimating){setAnimationState(!0);var a=document.querySelector("#drawnCards img"),r=document.querySelectorAll(".series-container")[n],o=a.getBoundingClientRect(),r=r.getBoundingClientRect();let e=document.createElement("img");e.src=cardImageFile(t),e.className="flying-card",e.style.position="fixed",e.style.left=o.left+"px",e.style.top=o.top+"px",e.style.width=a.offsetWidth+"px",e.style.height=a.offsetHeight+"px",e.style.zIndex="1000",document.body.appendChild(e);t=r.left+r.width/2-(o.left+o.width/2),a=r.top+r.height/2-(o.top+o.height/2);anime({targets:e,translateX:t,translateY:a,scale:1,opacity:1,duration:400,easing:"easeOutQuad",complete:()=>{e.remove(),placeCardOnSeries(n),setAnimationState(!1)}})}}function animateCardDraw(c){if(!isAnimating){setAnimationState(!0);let o=document.getElementById("drawnCards");let i=document.getElementById("deck").getBoundingClientRect(),l=o.getBoundingClientRect(),d=[...o.querySelectorAll("img")],s=[],u=0;c.forEach((e,t)=>{let n=document.createElement("img");n.src=cardImageFile(e),n.alt=formatCard(e),n.className="card-img",n.style.opacity="0",n.style.position="fixed",n.style.left=i.left+i.width/2-15+"px",n.style.top=i.top+i.height/2-30+"px",n.style.width="100px",n.style.zIndex=100+t,document.body.appendChild(n);var a=l.left+(0===t?0:1===t?15:30),r=l.top;anime({targets:n,translateX:a-parseFloat(n.style.left),translateY:r-parseFloat(n.style.top),opacity:1,duration:500,delay:150*t,easing:"easeOutExpo",complete:()=>{s.push({img:n,card:e}),++u===c.length&&(d.forEach(e=>e.remove()),o.innerHTML="",s.forEach((e,t)=>{let{img:n,card:a}=e;n.style.position="absolute",n.style.left="",n.style.top="",n.style.transform="none",n.style.opacity="1",n.style.zIndex="",o.appendChild(n),0===t?n.style.left="0px":1===t?n.style.left="15px":2===t&&(n.style.left="30px"),n.addEventListener("click",()=>{tryAutoPlaceCard(a)}),setAnimationState(!1)}))}})})}}function animateUndoDraw(l,d,s,u){if(!isAnimating){setAnimationState(!0);let o=[],i=0;l.forEach((e,n)=>{var a=d[n].getBoundingClientRect();let r=document.createElement("img");r.src=cardImageFile(e),r.className="flying-card",r.style.position="fixed",r.style.left=a.left+"px",r.style.top=a.top+"px",r.style.width="80px",r.style.height="120px",r.style.zIndex=100+n,document.body.appendChild(r);e=s.left+s.width/2-35-a.left,a=s.top+s.height/2-55-a.top;anime({targets:r,translateX:e,translateY:a,opacity:.5,duration:500,delay:150*n,easing:"easeOutExpo",complete:()=>{o.push(r),++i===l.length&&(o.forEach(e=>e.remove()),u.innerHTML="",drawIndex-=lastDrawCount,updateUI(),document.getElementById("status").innerText=t("statusUndoDone",{n:3}),lastDrawCount=0,undoEnabled=!1,selectedCard=null,setAnimationState(!1))}})})}}function triggerWinCelebration(){if(window.confetti){let t=Date.now()+3e3;!function e(){confetti({particleCount:5,angle:60,spread:55,origin:{x:0}}),confetti({particleCount:5,angle:120,spread:55,origin:{x:1}}),Date.now()<t&&requestAnimationFrame(e)}()}playSound("winSound"),document.querySelectorAll(".card-img").forEach((e,t)=>{anime({targets:e,translateY:-600,rotate:720,opacity:0,duration:1e3,delay:50*t,easing:"easeInQuad"})}),setTimeout(()=>{var e=document.getElementById("winModal"),t=document.getElementById("winStats");e&&t&&(t.innerText="üèÜ Kazandƒ±nƒ±z! Skor: "+score,e.style.display="flex")},1500)}((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.anime=t()})(this,function(){var l={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},b={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},z=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],c={CSS:{},springs:{}};function C(e,t,n){return Math.min(Math.max(e,t),n)}function s(e,t){return-1<e.indexOf(t)}function o(e,t){return e.apply(null,t)}var w={arr:function(e){return Array.isArray(e)},obj:function(e){return s(Object.prototype.toString.call(e),"Object")},pth:function(e){return w.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||w.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},nil:function(e){return w.und(e)||null===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return w.hex(e)||w.rgb(e)||w.hsl(e)},key:function(e){return!l.hasOwnProperty(e)&&!b.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function m(e){e=/\(([^)]+)\)/.exec(e);return e?e[1].split(",").map(function(e){return parseFloat(e)}):[]}function i(a,n){var e=m(a),t=C(w.und(e[0])?1:e[0],.1,100),r=C(w.und(e[1])?100:e[1],.1,100),o=C(w.und(e[2])?10:e[2],.1,100),e=C(w.und(e[3])?0:e[3],.1,100),i=Math.sqrt(r/t),l=o/(2*Math.sqrt(r*t)),d=l<1?i*Math.sqrt(1-l*l):0,s=l<1?(l*i-e)/d:-e+i;function u(e){var t=n?n*e/1e3:e,t=l<1?Math.exp(-t*l*i)*(+Math.cos(d*t)+s*Math.sin(d*t)):(1+s*t)*Math.exp(-t*i);return 0===e||1===e?e:1-t}return n?u:function(){var e=c.springs[a];if(e)return e;for(var t=0,n=0;;)if(1===u(t+=1/6)){if(16<=++n)break}else n=0;e=t*(1/6)*1e3;return c.springs[a]=e}}function F(t){return void 0===t&&(t=10),function(e){return Math.ceil(C(e,1e-6,1)*t)*(1/t)}}var t,n,U=function(k,t,b,n){if(0<=k&&k<=1&&0<=b&&b<=1){var I=new Float32Array(11);if(k!==t||b!==n)for(var e=0;e<11;++e)I[e]=E(.1*e,k,b);return function(e){return k===t&&b===n||0===e||1===e?e:E((e=>{for(var t=0,n=1;10!==n&&I[n]<=e;++n)t+=.1;var a=t+(e-I[--n])/(I[n+1]-I[n])*.1,r=x(a,k,b);if(.001<=r){for(var o=e,i=a,l=k,d=b,s=0;s<4;++s){var u=x(i,l,d);if(0===u)return i;i-=(E(i,l,d)-o)/u}return i}if(0===r)return a;for(var c,m,g=e,f=t,y=t+.1,p=k,h=b,v=0;0<(c=E(m=f+(y-f)/2,p,h)-g)?y=m:f=m,1e-7<Math.abs(c)&&++v<10;);return m})(e),t,n)}}},d=(t={linear:function(){return function(e){return e}}},n={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===t&&(t=.5);var n=C(e=void 0===e?1:e,1,10),a=C(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-a/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/a)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach(function(e,t){n[e]=function(){return function(e){return Math.pow(e,t+2)}}}),Object.keys(n).forEach(function(e){var a=n[e];t["easeIn"+e]=a,t["easeOut"+e]=function(t,n){return function(e){return 1-a(t,n)(1-e)}},t["easeInOut"+e]=function(t,n){return function(e){return e<.5?a(t,n)(2*e)/2:1-a(t,n)(-2*e+2)/2}},t["easeOutIn"+e]=function(t,n){return function(e){return e<.5?(1-a(t,n)(1-2*e))/2:(a(t,n)(2*e-1)+1)/2}}}),t);function a(e,t){return 1-3*t+3*e}function E(e,t,n){return((a(t,n)*e+(3*n-6*t))*e+3*t)*e}function x(e,t,n){return 3*a(t,n)*e*e+2*(3*n-6*t)*e+3*t}function S(e,t){if(w.fnc(e))return e;var n=e.split("(")[0],a=d[n],r=m(e);switch(n){case"spring":return i(e,t);case"cubicBezier":return o(U,r);case"steps":return o(F,r);default:return o(a,r)}}function r(e){try{return document.querySelectorAll(e)}catch(e){}}function M(e,t){for(var n,a=e.length,r=2<=arguments.length?t:void 0,o=[],i=0;i<a;i++)i in e&&(n=e[i],t.call(r,n,i,e))&&o.push(n);return o}function u(e){return e.reduce(function(e,t){return e.concat(w.arr(t)?u(t):t)},[])}function g(e){return w.arr(e)?e:(e=w.str(e)?r(e)||e:e)instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e]}function f(e,t){return e.some(function(e){return e===t})}function y(e){var t,n={};for(t in e)n[t]=e[t];return n}function I(e,t){var n,a=y(e);for(n in e)a[n]=(t.hasOwnProperty(n)?t:e)[n];return a}function B(e,t){var n,a=y(e);for(n in t)a[n]=(w.und(e[n])?t:e)[n];return a}function T(e){e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(e)return e[1]}function p(e,t){return w.fnc(e)?e(t.target,t.id,t.total):e}function h(e,t){return e.getAttribute(t)}function v(e,t,n){var a,r,o;return f([n,"deg","rad","turn"],T(t))?t:(a=c.CSS[t+n],w.und(a)?(r=document.createElement(e.tagName),(e=e.parentNode&&e.parentNode!==document?e.parentNode:document.body).appendChild(r),r.style.position="absolute",r.style.width=100+n,o=100/r.offsetWidth,e.removeChild(r),e=o*parseFloat(t),c.CSS[t+n]=e):a)}function _(e,t,n){var a;if(t in e.style)return a=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t=e.style[t]||getComputedStyle(e).getPropertyValue(a)||"0",n?v(e,t,n):t}function k(e,t){return w.dom(e)&&!w.inp(e)&&(!w.nil(h(e,t))||w.svg(e)&&e[t])?"attribute":w.dom(e)&&f(z,t)?"transform":w.dom(e)&&"transform"!==t&&_(e,t)?"css":null!=e[t]?"object":void 0}function q(e){if(w.dom(e)){for(var t,n=e.style.transform||"",a=/(\w+)\(([^)]*)\)/g,r=new Map;t=a.exec(n);)r.set(t[1],t[2]);return r}}function L(e,t,n,a){switch(k(e,t)){case"transform":return r=e,i=a,l=n,d=s(o=t,"scale")?1:0+(s(d=o,"translate")||"perspective"===d?"px":s(d,"rotate")||s(d,"skew")?"deg":void 0),d=q(r).get(o)||d,i&&(i.transforms.list.set(o,d),i.transforms.last=o),l?v(r,d,l):d;case"css":return _(e,t,n);case"attribute":return h(e,t);default:return e[t]||0}var r,o,i,l,d}function A(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var a=T(e)||0,r=parseFloat(t),o=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return r+o+a;case"-":return r-o+a;case"*":return r*o+a}}function R(e,t){var n,a,r,o,i,l,d;return w.col(e)?(l=e,w.rgb(l)?(o=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(i=l))?"rgba("+o[1]+",1)":i:w.hex(l)?(o=l.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,a){return t+t+n+n+a+a}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o),"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+",1)"):w.hsl(l)?(o=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(o=l)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(o),i=parseInt(o[1],10)/360,l=parseInt(o[2],10)/100,d=parseInt(o[3],10)/100,o=o[4]||1,0==l?n=a=r=d:(n=s(l=2*d-(d=d<.5?d*(1+l):d+l-d*l),d,i+1/3),a=s(l,d,i),r=s(l,d,i-1/3)),"rgba("+255*n+","+255*a+","+255*r+","+o+")"):void 0):/\s/g.test(e)?e:(d=(l=T(e))?e.substr(0,e.length-l.length):e,t?d+t:d);function s(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}}function D(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function J(e){for(var t,n=e.points,a=0,r=0;r<n.numberOfItems;r++){var o=n.getItem(r);0<r&&(a+=D(t,o)),t=o}return a}function G(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return 2*Math.PI*h(e,"r");case"rect":return 2*h(t=e,"width")+2*h(t,"height");case"line":return D({x:h(t=e,"x1"),y:h(t,"y1")},{x:h(t,"x2"),y:h(t,"y2")});case"polyline":return J(e);case"polygon":return t=e.points,J(e)+D(t.getItem(t.numberOfItems-1),t.getItem(0))}var t}function j(t,e){var e=e||{},n=e.el||(()=>{for(var e=t.parentNode;w.svg(e)&&w.svg(e.parentNode);)e=e.parentNode;return e})(),a=n.getBoundingClientRect(),r=h(n,"viewBox"),o=a.width,a=a.height,e=e.viewBox||(r?r.split(" "):[0,0,o,a]);return{el:n,viewBox:e,x:+e[0],y:+e[1],w:o,h:a,vW:e[2],vH:e[3]}}function W(e,t){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,a=R(w.pth(e)?e.totalLength:e,t)+"";return{original:a,numbers:a.match(n)?a.match(n).map(Number):[0],strings:w.str(e)||t?a.split(n):[]}}function H(e){return M(e?u(w.arr(e)?e.map(g):g(e)):[],function(e,t,n){return n.indexOf(e)===t})}function $(e){var n=H(e);return n.map(function(e,t){return{target:e,id:t,total:n.length,transforms:{list:q(e)}}})}function Y(e,t){var n,a=[],r=t.keyframes;for(n in t=r?B((t=>{for(var n=M(u(t.map(function(e){return Object.keys(e)})),function(e){return w.key(e)}).reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[]),r={},e=0;e<n.length;e++)(e=>{var a=n[e];r[a]=t.map(function(e){var t,n={};for(t in e)w.key(t)?t==a&&(n.value=e[t]):n[t]=e[t];return n})})(e);return r})(r),t):t)w.key(n)&&a.push({name:n,tweens:((e,n)=>{var t,a=y(n),r=(/^spring/.test(a.easing)&&(a.duration=i(a.easing)),w.arr(e)&&(2!==(t=e.length)||w.obj(e[0])?w.fnc(n.duration)||(a.duration=n.duration/t):e={value:e}),w.arr(e)?e:[e]);return r.map(function(e,t){e=w.obj(e)&&!w.pth(e)?e:{value:e};return w.und(e.delay)&&(e.delay=t?0:n.delay),w.und(e.endDelay)&&(e.endDelay=t===r.length-1?n.endDelay:0),e}).map(function(e){return B(e,a)})})(t[n],e)});return a}function V(l,d){var s;return l.tweens.map(function(e){var e=((e,t)=>{var n,a={};for(n in e){var r=p(e[n],t);w.arr(r)&&1===(r=r.map(function(e){return p(e,t)})).length&&(r=r[0]),a[n]=r}return a.duration=parseFloat(a.duration),a.delay=parseFloat(a.delay),a})(e,d),t=e.value,n=w.arr(t)?t[1]:t,a=T(n),r=L(d.target,l.name,a,d),o=s?s.to.original:r,i=w.arr(t)?t[0]:o,r=T(i)||T(r),a=a||r;return w.und(n)&&(n=o),e.from=W(i,a),e.to=W(A(n,i),a),e.start=s?s.end:0,e.end=e.start+e.delay+e.duration+e.endDelay,e.easing=S(e.easing,e.duration),e.isPath=w.pth(t),e.isPathTargetInsideSVG=e.isPath&&w.svg(d.target),e.isColor=w.col(e.from.original),e.isColor&&(e.round=1),s=e})}var X={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,a,r){var o;a.list.set(t,n),t!==a.last&&!r||(o="",a.list.forEach(function(e,t){o+=t+"("+e+") "}),e.style.transform=o)}};function Z(e,i){$(e).forEach(function(e){for(var t in i){var n=p(i[t],e),a=e.target,r=T(n),o=L(a,t,r,e),n=A(R(n,r||T(o)),o),r=k(a,t);X[r](a,t,n,e.transforms,!0)}})}function K(e,t){return M(u(e.map(function(o){return t.map(function(e){var t,n,a=o,r=k(a.target,e.name);if(r)return n=(t=V(e,a))[t.length-1],{type:r,property:e.name,animatable:a,tweens:t,duration:n.end,delay:t[0].delay,endDelay:n.endDelay}})})),function(e){return!w.und(e)})}function Q(e,t){function n(e){return e.timelineOffset||0}var a=e.length,r={};return r.duration=a?Math.max.apply(Math,e.map(function(e){return n(e)+e.duration})):t.duration,r.delay=a?Math.min.apply(Math,e.map(function(e){return n(e)+e.delay})):t.delay,r.endDelay=a?r.duration-Math.max.apply(Math,e.map(function(e){return n(e)+e.duration-e.endDelay})):t.endDelay,r}var N,ee=0,O=[],te=("undefined"!=typeof document&&document.addEventListener("visibilitychange",function(){P.suspendWhenDocumentHidden&&(e()?N=cancelAnimationFrame(N):(O.forEach(function(e){return e._onDocumentVisibility()}),te()))}),function(){!(N||e()&&P.suspendWhenDocumentHidden)&&0<O.length&&(N=requestAnimationFrame(ne))});function ne(e){for(var t=O.length,n=0;n<t;){var a=O[n];a.paused?(O.splice(n,1),t--):(a.tick(e),n++)}N=0<n?requestAnimationFrame(ne):void 0}function e(){return document&&document.hidden}function P(e){var d,s=0,u=0,c=0,m=0,g=null;function f(e){var t=window.Promise&&new Promise(function(e){return g=e});e.finished=t}t=I(l,e=e=void 0===e?{}:e),n=Y(a=I(b,e),e),a=Q(n=K(e=$(e.targets),n),a),r=ee,ee++;var t,n,a,r,E=B(t,{id:r,children:[],animatables:e,animations:n,duration:a.duration,delay:a.delay,endDelay:a.endDelay});function y(){var e=E.direction;"alternate"!==e&&(E.direction="normal"!==e?"normal":"reverse"),E.reversed=!E.reversed,d.forEach(function(e){return e.reversed=E.reversed})}function p(e){return E.reversed?E.duration-e:e}function o(){s=0,u=p(E.currentTime)*(1/P.speed)}function h(e,t){t&&t.seek(e-t.timelineOffset)}function v(t){for(var e=0,n=E.animations,a=n.length;e<a;){var r=n[e],o=r.animatable,i=r.tweens,l=i.length-1,d=i[l];l&&(d=M(i,function(e){return t<e.end})[0]||d);for(var l=C(t-d.start-d.delay,0,d.duration)/d.duration,s=isNaN(l)?1:d.easing(l),u=d.to.strings,c=d.round,m=[],g=d.to.numbers.length,f=void 0,y=0;y<g;y++){var p=void 0,h=d.to.numbers[y],v=d.from.numbers[y]||0,p=d.isPath?((t,n,e)=>{function a(e){return t.el.getPointAtLength(1<=n+(e=void 0===e?0:e)?n+e:0)}var r=j(t.el,t.svg),o=a(),i=a(-1),l=a(1),d=e?1:r.w/r.vW,s=e?1:r.h/r.vH;switch(t.property){case"x":return(o.x-r.x)*d;case"y":return(o.y-r.y)*s;case"angle":return 180*Math.atan2(l.y-i.y,l.x-i.x)/Math.PI}})(d.value,s*h,d.isPathTargetInsideSVG):v+s*(h-v);!c||d.isColor&&2<y||(p=Math.round(p*c)/c),m.push(p)}var k=u.length;if(k)for(var f=u[0],b=0;b<k;b++){u[b];var I=u[b+1],w=m[b];isNaN(w)||(f+=I?w+I:w+" ")}else f=m[0];X[r.type](o.target,r.property,f,o.transforms),r.currentValue=f,e++}}function k(e){E[e]&&!E.passThrough&&E[e](E)}function i(e){var t=E.duration,n=E.delay,a=t-E.endDelay,r=p(e);if(E.progress=C(r/t*100,0,100),E.reversePlayback=r<E.currentTime,d){var o=r;if(E.reversePlayback)for(var i=m;i--;)h(o,d[i]);else for(var l=0;l<m;l++)h(o,d[l])}!E.began&&0<E.currentTime&&(E.began=!0,k("begin")),!E.loopBegan&&0<E.currentTime&&(E.loopBegan=!0,k("loopBegin")),r<=n&&0!==E.currentTime&&v(0),(a<=r&&E.currentTime!==t||!t)&&v(t),n<r&&r<a?(E.changeBegan||(E.changeBegan=!0,E.changeCompleted=!1,k("changeBegin")),k("change"),v(r)):E.changeBegan&&(E.changeCompleted=!0,E.changeBegan=!1,k("changeComplete")),E.currentTime=C(r,0,t),E.began&&k("update"),t<=e&&(u=0,E.remaining&&!0!==E.remaining&&E.remaining--,E.remaining?(s=c,k("loopComplete"),E.loopBegan=!1,"alternate"===E.direction&&y()):(E.paused=!0,E.completed||(E.completed=!0,k("loopComplete"),k("complete"),!E.passThrough&&"Promise"in window&&(g(),f(E)))))}return f(E),E.reset=function(){var e=E.direction;E.passThrough=!1,E.currentTime=0,E.progress=0,E.paused=!0,E.began=!1,E.loopBegan=!1,E.changeBegan=!1,E.completed=!1,E.changeCompleted=!1,E.reversePlayback=!1,E.reversed="reverse"===e,E.remaining=E.loop,d=E.children;for(var t=m=d.length;t--;)E.children[t].reset();(E.reversed&&!0!==E.loop||"alternate"===e&&1===E.loop)&&E.remaining++,v(E.reversed?E.duration:0)},E._onDocumentVisibility=o,E.set=function(e,t){return Z(e,t),E},E.tick=function(e){i(((c=e)+(u-(s=s||c)))*P.speed)},E.seek=function(e){i(p(e))},E.pause=function(){E.paused=!0,o()},E.play=function(){E.paused&&(E.completed&&E.reset(),E.paused=!1,O.push(E),o(),te())},E.reverse=function(){y(),E.completed=!E.reversed,o()},E.restart=function(){E.reset(),E.play()},E.remove=function(e){re(H(e),E)},E.reset(),E.autoplay&&E.play(),E}function ae(e,t){for(var n=t.length;n--;)f(e,t[n].animatable.target)&&t.splice(n,1)}function re(e,t){var n=t.animations,a=t.children;ae(e,n);for(var r=a.length;r--;){var o=a[r],i=o.animations;ae(e,i),i.length||o.children.length||a.splice(r,1)}n.length||a.length||t.pause()}return P.version="3.2.1",P.speed=1,P.suspendWhenDocumentHidden=!0,P.running=O,P.remove=function(e){for(var t=H(e),n=O.length;n--;)re(t,O[n])},P.get=L,P.set=Z,P.convertPx=v,P.path=function(e,t){var n=w.str(e)?r(e)[0]:e,a=t||100;return function(e){return{property:e,el:n,svg:j(n),totalLength:G(n)*(a/100)}}},P.setDashoffset=function(e){var t=G(e);return e.setAttribute("stroke-dasharray",t),t},P.stagger=function(e,t){var l=(t=void 0===t?{}:t).direction||"normal",d=t.easing?S(t.easing):null,s=t.grid,u=t.axis,c=t.from||0,m="first"===c,g="center"===c,f="last"===c,y=w.arr(e),p=y?parseFloat(e[0]):parseFloat(e),h=y?parseFloat(e[1]):0,v=T(y?e[1]:e)||0,k=t.start||0+(y?p:0),b=[],I=0;return function(e,t,n){if(m&&(c=0),g&&(c=(n-1)/2),f&&(c=n-1),!b.length){for(var a,r,o,i=0;i<n;i++)s?(a=g?(s[0]-1)/2:c%s[0],r=g?(s[1]-1)/2:Math.floor(c/s[0]),a=a-i%s[0],r=r-Math.floor(i/s[0]),o=Math.sqrt(a*a+r*r),"x"===u&&(o=-a),b.push(o="y"===u?-r:o)):b.push(Math.abs(c-i)),I=Math.max.apply(Math,b);d&&(b=b.map(function(e){return d(e/I)*I})),"reverse"===l&&(b=b.map(function(e){return u?e<0?-1*e:-e:Math.abs(I-e)}))}return k+(y?(h-p)/I:p)*(Math.round(100*b[t])/100)+v}},P.timeline=function(i){var l=P(i=void 0===i?{}:i);return l.duration=0,l.add=function(e,t){var n=O.indexOf(l),a=l.children;function r(e){e.passThrough=!0}-1<n&&O.splice(n,1);for(var o=0;o<a.length;o++)r(a[o]);n=B(e,I(b,i)),n.targets=n.targets||i.targets,e=l.duration,n.autoplay=!1,n.direction=l.direction,n.timelineOffset=w.und(t)?e:A(t,e),r(l),l.seek(n.timelineOffset),t=P(n),r(t),a.push(t),e=Q(a,i);return l.delay=e.delay,l.endDelay=e.endDelay,l.duration=e.duration,l.seek(0),l.reset(),l.autoplay&&l.play(),l},l},P.easing=S,P.penner=d,P.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},P}),document.getElementById("deck").addEventListener("click",drawThree),document.getElementById("undoBtn").addEventListener("click",undoDraw),document.getElementById("useJokerBtn").addEventListener("click",useJoker),document.getElementById("showScoreHistoryBtn").addEventListener("click",showScoreHistory),document.getElementById("homeBtn").addEventListener("click",backToMainMenu),document.getElementById("openHelpBtn").addEventListener("click",openHelp),document.getElementById("openNewGameBtn").addEventListener("click",openSettingsModal),document.getElementById("newGameBtn").addEventListener("click",startGameFromModal),document.getElementById("tryAgainBtn").addEventListener("click",openSettingsFromWin),document.getElementById("closeScoreHistoryBtn").addEventListener("click",closeScoreHistory),document.getElementById("closeHelpSpn").addEventListener("click",closeHelp),document.getElementById("closeHelpBtn").addEventListener("click",closeHelp),document.getElementById("resetBtn").addEventListener("click",()=>{document.getElementById("settingsModal").style.display="flex"}),document.getElementById("dailyChallengeBtn").addEventListener("click",startDailyChallenge),((e,t)=>{!function t(H,n,s,u){var a=!!(H.Worker&&H.Blob&&H.Promise&&H.OffscreenCanvas&&H.OffscreenCanvasRenderingContext2D&&H.HTMLCanvasElement&&H.HTMLCanvasElement.prototype.transferControlToOffscreen&&H.URL&&H.URL.createObjectURL);function r(){}function N(e){var t=n.exports.Promise,t=void 0!==t?t:H.Promise;return"function"==typeof t?new t(e):(e(r,r),null)}i=Math.floor(1e3/60),l={},d=0,o="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(e=function(n){var a=Math.random();return l[a]=requestAnimationFrame(function e(t){d===t||d+i-1<t?(d=t,delete l[a],n()):l[a]=requestAnimationFrame(e)}),a},function(e){l[e]&&cancelAnimationFrame(l[e])}):(e=function(e){return setTimeout(e,i)},function(e){return clearTimeout(e)});var e,o,i,l,d,c,m,g,f,y={frame:e,cancel:o},p=function(){var o;if(!c&&(!s&&a)){var e=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{c=new Worker(URL.createObjectURL(new Blob([e])))}catch(e){return"function"==typeof console.warn&&console.warn("üéä Could not load worker",e),null}(o=c).init=function(e){e=e.transferControlToOffscreen();o.postMessage({canvas:e},[e])},o.fire=function(e,t,a){var r;return m?(i(e,null),m):(r=Math.random().toString(36).slice(2),m=N(function(t){function n(e){e.data.callback===r&&(delete g[r],o.removeEventListener("message",n),m=null,a(),t())}o.addEventListener("message",n),i(e,r),g[r]=n.bind(null,{data:{callback:r}})}))},o.reset=function(){for(var e in o.postMessage({reset:!0}),g)g[e](),delete g[e]}}return c;function i(e,t){o.postMessage({options:e||{},callback:t})}},h={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!(g={}),scalar:1};function O(e,t,n){return e=(e&&null!=e[t]?e:h)[t],n?n(e):e}function P(e){return e<0?0:Math.floor(e)}function v(e){return parseInt(e,16)}function z(e){return e.map(k)}function k(e){e=String(e).replace(/[^0-9a-f]/gi,"");return{r:v((e=e.length<6?e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:e).substring(0,2)),g:v(e.substring(2,4)),b:v(e.substring(4,6))}}function b(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function I(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function F(n,e,a,r,o){var i,l,d=e.slice(),b=n.getContext("2d"),t=N(function(e){function t(){i=l=null,b.clearRect(0,0,r.width,r.height),o(),e()}i=y.frame(function e(){!s||r.width===u.width&&r.height===u.height||(r.width=n.width=u.width,r.height=n.height=u.height),r.width||r.height||(a(n),r.width=n.width,r.height=n.height),b.clearRect(0,0,r.width,r.height),(d=d.filter(function(e){var t=b,n=e;n.x+=Math.cos(n.angle2D)*n.velocity+n.drift,n.y+=Math.sin(n.angle2D)*n.velocity+n.gravity,n.wobble+=n.wobbleSpeed,n.velocity*=n.decay,n.tiltAngle+=.1,n.tiltSin=Math.sin(n.tiltAngle),n.tiltCos=Math.cos(n.tiltAngle),n.random=Math.random()+2,n.wobbleX=n.x+10*n.scalar*Math.cos(n.wobble),n.wobbleY=n.y+10*n.scalar*Math.sin(n.wobble);var a,r,o,i,l,d,e=n.tick++/n.totalTicks,s=n.x+n.random*n.tiltCos,u=n.y+n.random*n.tiltSin,c=n.wobbleX+n.random*n.tiltCos,m=n.wobbleY+n.random*n.tiltSin;if(t.fillStyle="rgba("+n.color.r+", "+n.color.g+", "+n.color.b+", "+(1-e)+")",t.beginPath(),"circle"===n.shape)t.ellipse?t.ellipse(n.x,n.y,Math.abs(c-s)*n.ovalScalar,Math.abs(m-u)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI):(e=t,a=n.x,r=n.y,o=Math.abs(c-s)*n.ovalScalar,i=Math.abs(m-u)*n.ovalScalar,l=Math.PI/10*n.wobble,d=2*Math.PI,e.save(),e.translate(a,r),e.rotate(l),e.scale(o,i),e.arc(0,0,1,0,d,void 0),e.restore());else if("star"===n.shape)for(var g,f,y=Math.PI/2*3,p=4*n.scalar,h=8*n.scalar,v=5,k=Math.PI/v;v--;)g=n.x+Math.cos(y)*h,f=n.y+Math.sin(y)*h,t.lineTo(g,f),y+=k,g=n.x+Math.cos(y)*p,f=n.y+Math.sin(y)*p,t.lineTo(g,f),y+=k;else t.moveTo(Math.floor(n.x),Math.floor(n.y)),t.lineTo(Math.floor(n.wobbleX),Math.floor(u)),t.lineTo(Math.floor(c),Math.floor(m)),t.lineTo(Math.floor(s),Math.floor(n.wobbleY));return t.closePath(),t.fill(),n.tick<n.totalTicks})).length?i=y.frame(e):t()}),l=t});return{addFettis:function(e){return d=d.concat(e),t},canvas:n,promise:t,reset:function(){i&&y.cancel(i),l&&l()}}}function w(C,e){var x,S=!C,M=!!O(e||{},"resize"),B=O(e,"disableForReducedMotion",Boolean),T=a&&O(e||{},"useWorker")?p():null,L=S?b:I,A=!(!C||!T||!C.__confetti_initialized),D="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function t(e){var t=B||O(e,"disableForReducedMotion",Boolean),n=O(e,"zIndex",Number);if(t&&D)return N(function(e){e()});S&&x?C=x.canvas:S&&!C&&(t=n,(n=document.createElement("canvas")).style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.pointerEvents="none",n.style.zIndex=t,C=n,document.body.appendChild(C)),M&&!A&&L(C);var a={width:C.width,height:C.height};function r(){var e;T?(L(e={getBoundingClientRect:function(){if(!S)return C.getBoundingClientRect()}}),T.postMessage({resize:{width:e.width,height:e.height}})):a.width=a.height=null}function o(){x=null,M&&H.removeEventListener("resize",r),S&&C&&(document.body.removeChild(C),C=null,A=!1)}if(T&&!A&&T.init(C),A=!0,T&&(C.__confetti_initialized=!0),M&&H.addEventListener("resize",r,!1),T)return T.fire(e,a,o);for(var i,l,d,t=e,n=a,e=o,s=O(t,"particleCount",P),u=O(t,"angle",Number),c=O(t,"spread",Number),m=O(t,"startVelocity",Number),g=O(t,"decay",Number),f=O(t,"gravity",Number),y=O(t,"drift",Number),p=O(t,"colors",z),h=O(t,"ticks",Number),v=O(t,"shapes"),k=O(t,"scalar"),b=((t=O(t,"origin",Object)).x=O(t,"x",Number),t.y=O(t,"y",Number),s),I=[],w=C.width*t.x,E=C.height*t.y;b--;)I.push((0,i=(d={x:w,y:E,angle:u,spread:c,startVelocity:m,color:p[b%p.length],shape:v[d=v.length,Math.floor(Math.random()*+d)+0],ticks:h,decay:g,gravity:f,drift:y,scalar:k}).angle*(Math.PI/180),l=d.spread*(Math.PI/180),{x:d.x,y:d.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*d.startVelocity+Math.random()*d.startVelocity,angle2D:-i+(.5*l-Math.random()*l),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:d.color,shape:d.shape,tick:0,totalTicks:d.ticks,decay:d.decay,drift:d.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*d.gravity,ovalScalar:.6,scalar:d.scalar}));return x?x.addFettis(I):(x=F(C,I,L,n,e)).promise}return t.reset=function(){T&&T.reset(),x&&x.reset()},t}function E(){return f=f||w(null,{useWorker:!0,resize:!0})}n.exports=function(){return E().apply(this,arguments)},n.exports.reset=function(){E().reset()},n.exports.create=w}(function(){return void 0!==e?e:"undefined"!=typeof self?self:this||{}}(),t,!1),e.confetti=t.exports})(window,{});let debug=!1,suits=["‚ô†","‚ô•","‚ô£","‚ô¶"],deck=[],drawIndex=0,drawnCards=[],table=[],currentRoundPlacedCards=0,moveCount=0,score=0,comboCount=0,highScore=Number(localStorage.getItem("highScore"))||0,startTime,timerInterval,selectedCard=null,completedSuits=[],lastDrawCount=0,undoEnabled=!1,difficultyLevel=3,hintTimeout=null,autoHintEnabled=Number(localStorage.getItem("autoHint")),jokerUsed=!1,seriesInfo=[{suit:"‚ô•",direction:"asc",label:"As ‚ô•",card_image:"ace_of_hearts.png"},{suit:"‚ô£",direction:"asc",label:"As ‚ô£",card_image:"ace_of_spades.png"},{suit:"‚ô¶",direction:"asc",label:"As ‚ô¶",card_image:"ace_of_diamonds.png"},{suit:"‚ô†",direction:"asc",label:"As ‚ô†",card_image:"ace_of_clubs.png"},{suit:"‚ô•",direction:"desc",label:"Papaz ‚ô•",card_image:"king_of_hearts.png"},{suit:"‚ô£",direction:"desc",label:"Papaz ‚ô£",card_image:"king_of_spades.png"},{suit:"‚ô¶",direction:"desc",label:"Papaz ‚ô¶",card_image:"ace_of_diamonds.png"},{suit:"‚ô†",direction:"desc",label:"Papaz ‚ô†",card_image:"ace_of_clubs.png"}];function createDeck(){var e=document.getElementById("winModal"),e=(e&&(e.style.display="none"),difficultyLevel=Number(document.getElementById("difficultySelect").value),deck=shuffle(deck=suits.flatMap(n=>Array.from({length:13},(e,t)=>({suit:n,rank:t+1,faceUp:!1})))),drawIndex=0,drawnCards=[],table=Array.from({length:8},()=>[]),moveCount=score=0,completedSuits=[],jokerUsed=!1,document.getElementById("useJokerBtn").disabled=!1,updateCounters(),document.getElementById("autoHintToggle"));e&&(autoHintEnabled=e.checked,localStorage.setItem("autoHint",autoHintEnabled?"1":"0")),updateUI(),updateJokerButtonState(),renderDeckStack(),startTime=Date.now(),clearInterval(timerInterval),timerInterval=setInterval(updateTimer,1e3),document.getElementById("status").innerText=""}function shuffle(e){return e.sort(()=>Math.random()-.5)}function drawThree(){if(comboCount=0,document.getElementById("status").innerText="",drawIndex>=deck.length)return 0===currentRoundPlacedCards&&!0===jokerUsed?void(document.getElementById("status").innerText=t("statusGameOver",{n:3})):(drawIndex=0,currentRoundPlacedCards=0,drawnCards=[],selectedCard=null,playNewTurnSound(),void updateUI());moveCount++,updateCounters();var e=deck.length-drawIndex,n=Math.min(difficultyLevel,e),a=(lastDrawCount=n,undoEnabled=!0,hintTimeout&&clearTimeout(hintTimeout),autoHintEnabled&&(hintTimeout=setTimeout(()=>{showHint()},3e3)),[]);for(let e=0;e<n;e++){var r=deck[drawIndex];r.faceUp=!0,drawnCards.push(r),drawIndex++,a.push(r)}animateCardDraw(a),updateJokerButtonState(),renderDeckStack()}function undoDraw(){var e,n,a,r;undoEnabled?0===lastDrawCount||drawnCards.length<lastDrawCount?(document.getElementById("status").innerText=t("statusUndoNone",{n:3}),setAnimationState(!1)):(e=document.getElementById("deck").getBoundingClientRect(),n=document.getElementById("drawnCards"),a=drawnCards.slice(-lastDrawCount),r=[...n.querySelectorAll("img")],drawnCards.splice(-lastDrawCount,lastDrawCount),animateUndoDraw(a,r,e,n)):(document.getElementById("status").innerText=t("statusUndoBlocked",{n:3}),setAnimationState(!1))}function checkSuitCompletion(n){completedSuits.includes(n)||13===seriesInfo.map((e,t)=>e.suit===n?t:-1).filter(e=>-1!==e).reduce((e,t)=>e+table[t].length,0)&&(completedSuits.push(n),score+=100,updateCounters(),document.getElementById("status").innerText=`üéâ ${n} serisi tamamlandƒ±! +100 puan`)}function canPlaceCardOnSeries(e,t){var{suit:n,direction:a}=seriesInfo[e],e=table[e],e=e[e.length-1];return t.suit===n&&(e?"asc"===a?t.rank===e.rank+1:t.rank===e.rank-1:"asc"===a?1===t.rank:13===t.rank)}function placeCardOnSeries(e){if(updateJokerButtonState(),0!==drawnCards.length){hintTimeout&&clearTimeout(hintTimeout);let n=drawnCards[drawnCards.length-1];if(canPlaceCardOnSeries(e,n)){playDropSound(),table[e].push(n),undoEnabled=!1,13===table[e].length&&(score+=100,document.getElementById("status").innerText=t("statusSeriesComplete",{n:3})),drawnCards.pop();e=deck.findIndex(e=>e.suit===n.suit&&e.rank===n.rank),e=(-1!==e&&(deck.splice(e,1),drawIndex--),currentRoundPlacedCards++,5*(++comboCount-1));if(score+=10+e,updateCounters(),checkSuitCompletion(n.suit),updateUI(),52===table.flat().length){score+=500,updateCounters();var e=Math.floor((Date.now()-startTime)/1e3),a=Math.floor(e/60),e=e%60;saveScoreHistory(score,moveCount);let n=`${t("statusWin",{n:3})}
${t("moveLabel",{n:3})}: ${moveCount}, ${t("scoreLabel",{n:3})}: ${score}, ${t("durationLabel",{n:3})}: ${a}:`+e.toString().padStart(2,"0");markDailyCompleted(),score>highScore&&(localStorage.setItem("highScore",score),highScore=score,n+=`
`+t("statusNewRecord",{n:3})),updateCounters(),clearInterval(timerInterval),document.getElementById("status").innerText="",document.querySelectorAll(".card-img").forEach((e,t)=>{setTimeout(()=>{e.classList.add("win-fly")},50*t)}),setTimeout(()=>{var e=document.getElementById("winModal");document.getElementById("winStats").innerText=n.replaceAll("\n","\n"),triggerWinCelebration(),e.style.display="flex"},1e3)}}else document.getElementById("status").innerText=t("statusCardNotAllowed",{n:3})}}function tryAutoPlaceCard(n){let a=-1;for(let e=0;e<table.length;e++)if(canPlaceCardOnSeries(e,n)){a=e;break}-1===a?document.getElementById("status").innerText=t("statusCardNoTarget",{n:3}):animateCardToSeries(n,a)}function useJoker(){var e;jokerUsed?document.getElementById("status").innerText=t("statusJokerAlready",{n:3}):drawIndex>=deck.length?document.getElementById("status").innerText=t("statusJokerEmpty",{n:3}):(e=deck.splice(drawIndex,1)[0],deck.push(e),jokerUsed=!0,document.getElementById("useJokerBtn").disabled=!0,document.getElementById("status").innerText=t("statusJokerUsed",{n:3}),updateUI())}function showHint(){if(0!==drawnCards.length){var e,n=drawnCards[drawnCards.length-1];let t=-1;for(let e=0;e<table.length;e++)if(canPlaceCardOnSeries(e,n)){t=e;break}-1!==t&&(e=document.querySelectorAll(".series-container")[t],anime({targets:e,boxShadow:["0 0 0px rgba(255, 255, 0, 0)","0 0 20px 5px gold","0 0 0px rgba(255, 255, 0, 0)"],duration:1e3,easing:"easeInOutQuad"}))}}function seededShuffle(e,t){var n,t=(e=>{for(var t=0,n=1779033703^e.length;t<e.length;t++)n=Math.imul(n^e.charCodeAt(t),3432918353);return n=n<<13|n>>>19,function(){return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),(n^=n>>>16)>>>0}})(t);n=t();let a=function(){var e=n+=1831565813,e=Math.imul(e^e>>>15,1|e);return(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296};return e.map(e=>[a(),e]).sort((e,t)=>e[0]-t[0]).map(e=>e[1])}function getTodaySeed(){return(new Date).toISOString().split("T")[0]}function hasPlayedDaily(){var e=getTodaySeed();return localStorage.getItem("dailyChallengeCompleted")===e}function markDailyCompleted(){var e=getTodaySeed(),e=(localStorage.setItem("dailyChallengeCompleted",e),document.getElementById("dailyChallengeBtn"));e&&(e.disabled=!0,e.innerText=t("dailyCompleted"))}function updateDailyButtonState(){var e=document.getElementById("dailyChallengeBtn");e&&(hasPlayedDaily()?(e.disabled=!0,e.style.opacity=.5,e.innerText=t("dailyCompleted")):(e.disabled=!1,e.style.opacity=1,e.innerText=t("dailyChallenge")))}function startDailyChallenge(){hasPlayedDaily()?alert(t("alreadyCompleted")):(document.getElementById("mainMenu").style.display="none",document.getElementById("settingsModal").style.display="none",document.getElementById("deckArea").style.display="flex",document.getElementById("undoWrapper").style.display="flex",document.getElementById("jokerWrapper").style.display="flex",document.getElementById("counters").style.display="block",document.getElementById("gameArea").style.display="flex",createDeck(!0))}function createDeck(e=!1){var t=document.getElementById("winModal"),t=(t&&(t.style.display="none"),difficultyLevel=Number(document.getElementById("difficultySelect")?.value||3),suits.flatMap(n=>Array.from({length:13},(e,t)=>({suit:n,rank:t+1,faceUp:!1})))),e=(deck=e?seededShuffle(t,getTodaySeed()):shuffle(t),drawIndex=0,drawnCards=[],table=Array.from({length:8},()=>[]),moveCount=score=0,completedSuits=[],jokerUsed=!1,document.getElementById("useJokerBtn").disabled=!1,updateCounters(),document.getElementById("autoHintToggle"));e&&(autoHintEnabled=e.checked,localStorage.setItem("autoHint",autoHintEnabled?"1":"0")),updateUI(),renderDeckStack(),startTime=Date.now(),clearInterval(timerInterval),timerInterval=setInterval(updateTimer,1e3),document.getElementById("status").innerText=""}window.addEventListener("DOMContentLoaded",createDeck),window.addEventListener("DOMContentLoaded",updateDailyButtonState);let toggleDebugPanel=()=>{document.getElementById("debugPanel").style.display=debug?"block":"none"},currentLanguage=(toggleDebugPanel(),localStorage.getItem("deckoLang")||"tr"),translations={tr:{newGame:"üéÆ Yeni Oyun",dailyChallenge:"üóì G√ºnl√ºk G√∂rev",dailyCompleted:"‚úÖ G√ºnl√ºk G√∂rev Tamamlandƒ±",scoreHistory:"üìä Skor Ge√ßmi≈üi",help:"‚ùì Yardƒ±m",alreadyCompleted:"‚úÖ Bug√ºn√ºn g√∂revi zaten tamamlandƒ±!",settingsTitle:"üéÆ Yeni Oyun Ayarlarƒ±",difficultyEasy:"üü¢ Kolay (1 kart)",difficultyMedium:"üü° Orta (2 kart)",difficultyHard:"üî¥ Zor (3 kart)",autoHint:"üí° Otomatik ƒ∞pucu",start:"‚úÖ Ba≈üla",winTitle:"üèÜ Tebrikler!",playAgain:"üîÅ Tekrar Oyna",historyTitle:"üìä Skor Ge√ßmi≈üi",helpTitle:"‚ùì Oyun Kurallarƒ±",helpOk:"‚úÖ Anladƒ±m",nicknamePrompt:"üë§ Enter your Nickname",nicknameSave:"Kaydet",moveLabel:"Hamle",scoreLabel:"Skor",highScoreLabel:"Rekor",durationLabel:"S√ºre",noScores:"Hen√ºz skor kaydƒ± yok.",statusSeriesComplete:"üéâ {n}. seri tamamlandƒ±! +100 puan",statusGameOver:"üíÄ Oyun bitti! Hi√ß kart yerle≈ütiremedin.",statusWin:"Oyunu kazandƒ±nƒ±z!",statusNewRecord:"üéâ Yeni Rekor!",statusCardNotAllowed:"‚õî Bu kart bu seriye konulamaz.",statusUndoBlocked:"üö´ Geri alma devre dƒ±≈üƒ± (kart yerle≈ütirildi).",statusUndoNone:"‚õî Geri alƒ±nacak √ßekilmi≈ü kart yok.",statusUndoDone:"‚Ü©Ô∏è A√ßƒ±lan kartlar geri alƒ±ndƒ±.",statusJokerUsed:"üÉè Joker kullanƒ±ldƒ±! Kart sona ta≈üƒ±ndƒ±.",statusJokerAlready:"‚ùå Joker zaten kullanƒ±ldƒ±.",statusJokerEmpty:"‚õî Joker kullanƒ±lacak kart kalmadƒ±.",statusCardInvalid:"‚ùå Bu kart ge√ßersiz.",statusCardNoTarget:"‚ùå Bu kart i√ßin uygun bir seri yok."},en:{newGame:"üéÆ New Game",dailyChallenge:"üóì Daily Challenge",dailyCompleted:"‚úÖ Challenge Completed",scoreHistory:"üìä Score History",help:"‚ùì Help",alreadyCompleted:"‚úÖ Today's challenge already completed!",settingsTitle:"üéÆ Game Settings",difficultyEasy:"üü¢ Easy (1 card)",difficultyMedium:"üü° Medium (2 cards)",difficultyHard:"üî¥ Hard (3 cards)",autoHint:"üí° Auto Hint",start:"‚úÖ Start",winTitle:"üèÜ Congratulations!",playAgain:"üîÅ Play Again",historyTitle:"üìä Score History",helpTitle:"‚ùì Game Rules",helpOk:"‚úÖ Got it",nicknamePrompt:"üë§ Enter your Nickname",nicknameSave:"Save",moveLabel:"Moves",scoreLabel:"Score",highScoreLabel:"High Score",durationLabel:"Duration",noScores:"No score records yet.",statusSeriesComplete:"üéâ {n}th series complete! +100 pts",statusGameOver:"üíÄ Game over! You couldn't place any cards.",statusWin:"You Win!",statusNewRecord:"üéâ New High Score!",statusCardNotAllowed:"‚õî This card can't be placed here.",statusUndoBlocked:"üö´ Undo disabled (a card was placed).",statusUndoNone:"‚õî No drawn cards to undo.",statusUndoDone:"‚Ü©Ô∏è Drawn cards returned.",statusJokerUsed:"üÉè Joker used! Card sent to the end.",statusJokerAlready:"‚ùå Joker already used.",statusJokerEmpty:"‚õî No card to use Joker on.",statusCardInvalid:"‚ùå Invalid card.",statusCardNoTarget:"‚ùå No valid series for this card."}};function t(e,t={}){let n=translations[currentLanguage][e]||e;for(var[a,r]of Object.entries(t))n=n.replace(`{${a}}`,r);return n}function changeLanguage(e){currentLanguage=e,localStorage.setItem("deckoLang",e),updateLanguageTexts()}function updateLanguageTexts(){var e=e=>document.getElementById(e),n=(e("dailyChallengeBtn").innerText=hasPlayedDaily()?t("dailyCompleted"):t("dailyChallenge"),document.getElementById("openNewGameBtn").innerText=t("newGame"),document.getElementById("showScoreHistoryBtn").innerText=t("scoreHistory"),document.getElementById("openHelpBtn").innerText=t("help"),e("languageSelect")),n=(n&&(n.value=currentLanguage),e("settingsModal").querySelector("h2").innerText=t("settingsTitle"),e("difficultySelect").options),n=(3<=n.length&&(n[0].text=t("difficultyEasy"),n[1].text=t("difficultyMedium"),n[2].text=t("difficultyHard")),e("autoHintToggle").parentNode);n&&(n.lastChild.textContent=t("autoHint")),document.getElementById("newGameBtn").innerText=t("start"),e("winModal").querySelector("h2").innerText=t("winTitle"),e("winModal").querySelector("button").innerText=t("playAgain"),e("scoreHistoryModal").querySelector("h2").innerText=t("historyTitle"),e("helpModal").querySelector("h2").innerText=t("helpTitle"),e("helpModal").querySelector("button").innerText=t("helpOk"),e("nicknameModal").querySelector("h2").innerText=t("nicknamePrompt"),e("nicknameModal").querySelector("button").innerText=t("nicknameSave"),e("moveCounter").innerText=t("moveLabel")+": "+moveCount,e("scoreCounter").innerText=t("scoreLabel")+": "+score}function openHelp(){var e=document.getElementById("helpModal"),t=e.querySelector(".help-content"),n=e.querySelector("h2"),a=e.querySelector("button"),r={tr:`
        <p>üÉè 8 Serili oyunda ama√ß, t√ºm kartlarƒ± 8 farklƒ± seriye doƒüru ≈üekilde dizmektir.</p>
        <ul style="text-align: left; padding-left: 20px;">
          <li>4 seri k√º√ß√ºkten b√ºy√ºƒüe (As ‚û°Ô∏è Papaz)</li>
          <li>4 seri b√ºy√ºkten k√º√ß√ºƒüe (Papaz ‚û°Ô∏è As)</li>
          <li>Aynƒ± seri i√ßinde sadece aynƒ± t√ºr (√∂rneƒüin sadece ‚ô•) kartlar yerle≈ütirilebilir.</li>
          <li>Her √ßekimde 1, 2 veya 3 kart √ßekebilirsin (zorluk se√ßimine g√∂re).</li>
          <li>Doƒüru seriye kart koyarsan puan kazanƒ±rsƒ±n.</li>
          <li>Her kart yerle≈ütirmede 10 puan, seri tamamladƒ±ƒüƒ±nda ekstra 100 puan kazanƒ±rsƒ±n.</li>
          <li>Bir turda hi√ß kart yerle≈ütiremezsen yeni deste a√ßƒ±lƒ±r.</li>
          <li>Bir kere joker hakkƒ±n var! √áƒ±kmayan kartƒ± sona atabilirsin.</li>
          <li>En y√ºksek skoru ve en kƒ±sa s√ºrede bitirmeye √ßalƒ±≈ü!</li>
        </ul>
      `,en:`
        <p>üÉè The goal is to place all cards into 8 correct series.</p>
        <ul style="text-align: left; padding-left: 20px;">
          <li>4 series go ascending (Ace ‚û°Ô∏è King)</li>
          <li>4 series go descending (King ‚û°Ô∏è Ace)</li>
          <li>Only same-suit cards can be placed in a series.</li>
          <li>Each draw gives 1, 2, or 3 cards based on difficulty.</li>
          <li>Placing a card earns you points.</li>
          <li>+10 points per card placed, +100 for completing a series.</li>
          <li>If you can‚Äôt place any cards in a turn, a new draw starts.</li>
          <li>You can use one Joker to move a stuck card to the end.</li>
          <li>Try to score the most points in the shortest time!</li>
        </ul>
      `},o={tr:"‚ùì Oyun Kurallarƒ±",en:"‚ùì Game Rules"},i={tr:"‚úÖ Anladƒ±m",en:"‚úÖ Got it"};n.innerText=o[currentLanguage]||o.tr,t.innerHTML=r[currentLanguage]||r.tr,a.innerText=i[currentLanguage]||i.tr,e.style.display="flex"}function closeHelp(){document.getElementById("helpModal").style.display="none"}function openSettingsModal(){document.getElementById("mainMenu").style.display="none",document.getElementById("settingsModal").style.display="flex"}function backToMainMenu(){document.getElementById("mainMenu").style.display="flex",document.getElementById("gameArea").style.display="none",document.getElementById("undoWrapper").style.display="none",document.getElementById("jokerWrapper").style.display="none",document.getElementById("counters").style.display="none",document.getElementById("settingsModal").style.display="none"}function startGameFromModal(){document.getElementById("deckArea").style.display="flex",document.getElementById("undoWrapper").style.display="flex",document.getElementById("jokerWrapper").style.display="flex",document.getElementById("counters").style.display="block",document.getElementById("gameArea").style.display="flex";var e=document.getElementById("settingsModal");e&&(e.style.display="none"),createDeck()}function openSettingsFromWin(){var e=document.getElementById("winModal"),e=(e&&(e.style.display="none"),document.getElementById("settingsModal"));e&&(e.style.display="flex")}function openSettingsFromLoss(){var e=document.getElementById("settingsModal");e&&(e.style.display="flex")}function checkNickname(){localStorage.getItem("deckoNickname")?createDeck():document.getElementById("nicknameModal").style.display="block"}function submitNickname(){var e=document.getElementById("nicknameInput").value.trim();0<e.length?(localStorage.setItem("deckoNickname",e),document.getElementById("nicknameModal").style.display="none",createDeck()):alert("‚ùóPlease enter a valid nickname.")}function saveScoreHistory(e,t){var n=JSON.parse(localStorage.getItem("scoreHistory"))||[],a=Math.floor((Date.now()-startTime)/1e3),r=localStorage.getItem("deckoNickname");n.push({nickname:r,score:e,moves:t,duration:a,date:(new Date).toLocaleString()}),localStorage.setItem("scoreHistory",JSON.stringify(n))}function showScoreHistory(){var e=document.getElementById("scoreHistoryModal"),t=document.getElementById("scoreHistoryTable"),n=JSON.parse(localStorage.getItem("scoreHistory"))||[];if(0===n.length)t.innerHTML="<p>Hen√ºz skor kaydƒ± yok.</p>";else{n.sort((e,t)=>t.score!==e.score?t.score-e.score:e.duration-t.duration);n=n.slice(0,10);let r=`
          <table>
            <tr>
              <th>#</th>
              <th>Nickname</th>
              <th>Skor</th>
              <th>Hamle</th>
              <th>S√ºre</th>
            </tr>
        `;n.forEach((e,t)=>{var n=Math.floor(e.duration/60),a=e.duration%60;r+=`
              <tr>
                <td>${t+1}</td>
                <td>${e.nickname}</td>   <!-- added -->
                <td>${e.score}</td>
                <td>${e.moves}</td>
                <td>${n}:${a.toString().padStart(2,"0")}</td>
              </tr>
            `}),r+="</table>",t.innerHTML=r}e.style.display="flex"}function closeScoreHistory(){document.getElementById("scoreHistoryModal").style.display="none"}function clearScoreHistory(){localStorage.removeItem("scoreHistory"),showScoreHistory()}window.addEventListener("DOMContentLoaded",updateLanguageTexts),window.addEventListener("DOMContentLoaded",checkNickname);let soundEnabled=0;function playSound(e){soundEnabled&&(e=document.getElementById(e))&&(e.currentTime=0,e.play())}function playDropSound(){playSound("dropSound")}function playNewTurnSound(){playSound("newTurnSound")}function toggleSound(){soundEnabled=!soundEnabled,localStorage.setItem("deckoSound",soundEnabled?"1":"0");var e=document.getElementById("soundToggleBtn");e&&(e.innerText=soundEnabled?"üîä":"üîá")}function initializeSoundToggle(){var e=document.getElementById("soundToggleBtn");e&&(e.innerText=soundEnabled?"üîä":"üîá")}function updateCounters(){var e=` (${t("highScoreLabel",{n:3})}: ${highScore})`;document.getElementById("moveCounter").innerText=t("moveLabel",{n:3})+": "+moveCount,document.getElementById("scoreCounter").innerText=t("scoreLabel",{n:3})+": "+score+e}function cardImageFile(e){return`images/cards/standard/${{1:"ace",11:"jack",12:"queen",13:"king"}[e.rank]||e.rank}_of_${{"‚ô†":"spades","‚ô•":"hearts","‚ô¶":"diamonds","‚ô£":"clubs"}[e.suit]}.png`}function formatCard(e){return""+({1:"As",11:"Vale",12:"Kƒ±z",13:"Papaz"}[e.rank]||e.rank)+e.suit}function renderDeckStack(){var t=document.getElementById("deck"),n=(t.innerHTML="",Math.min(deck.length-drawIndex,5));for(let e=0;e<n;e++){var a=document.createElement("img");a.src="images/cards/standard/back.png",a.className="deck-card",a.style.position="absolute",a.style.right=2*e+"px",a.style.zIndex=e,t.appendChild(a)}0===n?t.classList.add("empty"):t.classList.remove("empty")}function updateJokerButtonState(){var e=document.getElementById("useJokerBtn");e&&(e.disabled=jokerUsed||0<drawnCards.length||drawIndex>=deck.length)}function updateUI(){updateJokerButtonState();var e=document.getElementById("deck");drawIndex>=deck.length?e.classList.add("empty"):e.classList.remove("empty");let r=document.getElementById("drawnCards");if(r.innerHTML="",0<drawnCards.length){e=Math.min(difficultyLevel,drawnCards.length),e=drawnCards.length-e;let a=drawnCards.slice(e);a.forEach((e,t)=>{var n=document.createElement("img");n.src=cardImageFile(e),n.alt=formatCard(e),n.className="card-img",n.style.zIndex=t+1,t===a.length-1&&(n.setAttribute("draggable","true"),n.addEventListener("click",()=>{tryAutoPlaceCard(e)})),r.appendChild(n)})}let o=document.getElementById("table");if(o.innerHTML="",table.forEach((e,t)=>{var n,a=document.createElement("div"),e=(a.className="series-container",e[e.length-1]);e?((n=document.createElement("img")).src=cardImageFile(e),n.alt=formatCard(e),n.className="card-img",a.appendChild(n),a.classList.remove("empty"),a.removeAttribute("data-label")):(a.classList.add("empty"),{suit:e,direction:n}=seriesInfo[t],a.classList.add(("asc"===n?"as":"king")+"-"+{"‚ô†":"spades","‚ô•":"hearts","‚ô¶":"diamonds","‚ô£":"clubs"}[e])),o.appendChild(a)}),debug){let n=document.getElementById("remainingCards");n.innerHTML="",deck.slice(drawIndex).forEach(e=>{var t=document.createElement("span");t.textContent=formatCard(e)+" ",n.appendChild(t)})}}function updateTimer(){var e=Math.floor((Date.now()-startTime)/1e3);Math.floor(e/60)}document.addEventListener("DOMContentLoaded",()=>{initializeSoundToggle();var e=document.getElementById("soundToggleBtn");e&&e.addEventListener("click",toggleSound)});